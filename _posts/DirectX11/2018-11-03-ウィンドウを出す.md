---
layout: post
title: ウィンドウを出す
category: DirectX11
---

Visual StudioでC++の空のプロジェクトを作ってください。それからSource.cppというファイルを作ってください。別にSource.cppという名前じゃなくてもいいですけどね。

``` cpp
// Source.cpp
int main()
{
    return 0;
}
```

これがC++における最小のコードですよね。この`main`関数がエントリーポイントと言ってプログラムのスタート地点です。知らない人の為に全部説明していきますよ！実行したらコンソールウィンドウが出ます。

さて、ウィンドウを出しましょう。Windows APIでは`CreateWindow`でウィンドウを作って`ShowWindow`でウィンドウを表示するとウィンドウを出せます、ざっくりいうと。

``` cpp
// Source.cpp
#define OEMRESOURCE
#include <Windows.h>

int main()
{
    HINSTANCE instance = GetModuleHandleW(nullptr);

    WNDCLASSW windowClass = {};
    windowClass.lpfnWndProc = DefWindowProcW;
    windowClass.hInstance = instance;
    windowClass.hCursor = (HCURSOR)LoadImageW(nullptr, MAKEINTRESOURCEW(OCR_NORMAL), IMAGE_CURSOR, 0, 0, LR_SHARED);
    windowClass.lpszClassName = L"GameLib";
    RegisterClassW(&windowClass);

    HWND handle = CreateWindowW(L"GameLib", L"GameLib", WS_OVERLAPPEDWINDOW, 0, 0, 640, 480, nullptr, nullptr, instance, nullptr);

    ShowWindow(handle, SW_SHOWNORMAL);

    return 0;
}
```

具体的にはこんな感じのコードを書きます。へぇこう書くのか、くらいに思っとけば大丈夫です。ぶっちゃけ私も定型文くらいにしか考えてませんし、全部覚えてないので書くときは自分の過去のコードとか見て書きます。Windows APIを使うのでWindows.hをインクルードします。`#define OEMRESOURCE`というのは、１２行目のOCR_NORMALを使えるようにするための物です。

そしてメインループという物も書きます。ゲームループと言ったりもします。メインループがないとウィンドウが出たと同時にアプリケーションが終わってウィンドウも消えてしまいます。

``` cpp
    ShowWindow(handle, SW_SHOWNORMAL);

    while (true)
    {
        MSG message = {};

        if (PeekMessageW(&message, nullptr, 0, 0, PM_REMOVE))
        {
            if (message.message == WM_QUIT)
                break;

            TranslateMessage(&message);
            DispatchMessageW(&message);
        }
        else
        {
            // ここにゲームの処理を書いていく
        }
    }

    return 0;
}
```

ShowWindowの下にメインループの下にメインループを書きました。`return 0;`は一番最後の行にないとダメです。メインループの前に`return 0;`があるとメインループの前にアプリケーションが終わるので意味が無いです。

Window.hppとWindow.cppというファイルを作ってください。